<%- include('partials/header') %>

<section class="shopping-hero">
  <div class="hero-inner container">
    <div class="hero-copy">
      <p class="hero-kicker">FreshMart</p>
      <h1><%= category === 'All' ? 'Quality Groceries, Delivered Simply' : category + ' Favourites' %></h1>
      <p>
        Browse our handpicked selection of seasonal produce, pantry staples, and daily essentials.
        Thoughtfully sourced, beautifully packed, and delivered right to your doorstep across Singapore.
      </p>
      <div class="hero-actions">
        <a href="/shopping" class="btn btn-success px-4">Shop All</a>
        <a href="/about" class="btn btn-outline-success px-4">Our Story</a>
      </div>
    </div>
    <div class="hero-art"></div>
  </div>
</section>

<section class="shopping-wrapper container">
  <aside class="filter-card">
    <div class="filter-header">
      <p class="text-muted small mb-1">Browse by</p>
      <h5>Categories</h5>
    </div>
    <ul class="category-list">
      <% categories.forEach((cat) => { %>
        <li>
          <a href="/shopping?category=<%= cat %>" class="<%= category === cat ? 'active' : '' %>">
            <span><%= cat %></span>
            <i class="bi bi-chevron-right"></i>
          </a>
        </li>
      <% }) %>
    </ul>

    <div class="price-filter">
      <p class="text-muted small mb-1">Filter by price</p>
      <input type="range" class="form-range" min="1" max="100" value="40">
      <div class="d-flex justify-content-between small text-muted">
        <span>$1</span>
        <span>$100</span>
      </div>
    </div>
  </aside>

  <div class="products-panel">
    <div class="products-topbar">
      <div>
        <p class="text-muted small mb-1">
          <a href="/" class="text-decoration-none text-success">Home</a>
          <span class="mx-2">â€º</span>
          <span><%= category === 'All' ? 'All Products' : category %></span>
        </p>
        <h2><%= category === 'All' ? 'All Products' : category %></h2>
      </div>
      <div class="sort-control">
        <label for="sortOptions" class="text-muted small me-2">Sort</label>
        <select id="sortOptions" class="form-select">
          <option>Recommended</option>
          <option>Price: Low to High</option>
          <option>Price: High to Low</option>
        </select>
      </div>
    </div>

    <% if (products && products.length > 0) { %>
      <div class="products-grid">
        <% products.forEach((product) => { %>
          <article class="shopping-card">
            <div class="card-image" style="background-image:url('/images/<%= product.image %>');"></div>
            <div class="card-body">
              <p class="product-category"><%= product.category %></p>
              <h5><%= product.productName %></h5>
              <p class="product-price">$<%= product.price.toFixed(2) %></p>
              <form action="/add-to-cart/<%= product.id %>" method="POST">
                <input type="hidden" name="quantity" value="1">
                <button class="btn btn-outline-success w-100">Add to Cart</button>
              </form>
            </div>
          </article>
        <% }) %>
      </div>
    <% } else { %>
      <div class="empty-state">
        <h4>Nothing to show yet</h4>
        <p>We couldn't find any products in this category. Try another filter or browse all products.</p>
        <a href="/shopping" class="btn btn-success">View All Products</a>
      </div>
    <% } %>
  </div>
</section>

<%- include('partials/footer') %>
